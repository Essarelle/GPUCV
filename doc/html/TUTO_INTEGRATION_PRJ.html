<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>GpuCV: Using GpuCV into your project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="twiki_style.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="TUTO_INTEGRATION_PRJ">Using GpuCV into your project </a></h1><h2><a class="anchor" id="TUTO_INTEGRATION_PRJ__SCT_INTRO">
Intro</a></h2>
<dl class="user"><dt><b>PRE-REQUIS</b></dt><dd><ul>
<li>
none </li>
</ul>
</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd></dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Yannick Allusse </dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd>GpuCV v0.4.2 rev 487 </dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Turorial tag: <b>TUTO_INTEGRATION_PRJ_TAG</b></dd></dl>
<p><br/>
In this tutorial, we will describe how to use GpuCV accelerated operators into your existing OpenCV application. You will be able to choose between the "easy-way" and GpuCV will use the auto-switch mechanism to find how to accelerate your application with minor code changes. Or you can choose to have full control of GpuCV calls and acceleration. <br/>
 <br/>
We will use the <b>morphology</b> sample supplied with OpenCV. The major differences are in the way you call 'OpenCV like' accelerated operators, see <a class="el" href="TUTO_INTEGRATION_PRJ.html#TUTO_INTEGRATION_PRJ__STP3__CODE_CHANGE">Code modifications</a>.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>All modified lines will be noticed by a !!GCV!! flag.</dd></dl>
<ol>
<li>
<a class="el" href="TUTO_INTEGRATION_PRJ.html#TUTO_INTEGRATION_PRJ__STP1__INCLUDE">Include files</a> </li>
<li>
<a class="el" href="TUTO_INTEGRATION_PRJ.html#TUTO_INTEGRATION_PRJ__STP2__LIBS">Library files</a> </li>
<li>
<a class="el" href="TUTO_INTEGRATION_PRJ.html#TUTO_INTEGRATION_PRJ__STP3__CODE_CHANGE">Code modifications</a> </li>
<li>
<a class="el" href="TUTO_INTEGRATION_PRJ.html#TUTO_INTEGRATION_PRJ__STP4__EXTRA_FILES">Extra files</a> </li>
</ol>
<h2><a class="anchor" id="TUTO_INTEGRATION_PRJ__STP1__INCLUDE">
Include files</a></h2>
<p>The first step to use GpuCV is to find out witch include files you need, depending on which level of the GPU implementation you want to use. GpuCV use some naming rules to identify the header files roles, based on OpenCV header files name ($NAME$.h) </p>
<ul>
<li>
$NAME$.h: Original OpenCV library header. </li>
<li>
$NAME$<b>g</b>.h: GpuCV-GLSL accelerated library header. Contains some <a class="el" href="namespacecv.html">cv</a><b>g</b>*() functions corresponding to OpenCV cv*() functions. </li>
<li>
$NAME$<b>gcu</b>.h: GpuCV-CUDA accelerated library header. Contains some <a class="el" href="namespacecv.html">cv</a><b>gCuda</b>*() functions corresponding to OpenCV cv*() functions. </li>
<li>
$NAME$<b>_switch</b>.h: GpuCV switch function library header. Contains all <a class="el" href="namespacecv.html">cv</a><b>gsw</b>*() functions corresponding to OpenCV cv*() functions. </li>
<li>
$NAME$<b>_switch_wrapper</b>.h: GpuCV switch function wrapper library header. Contains all cvgsw*() wrapping definitions to map with all OpenCV cv*() functions. </li>
</ul>
<p><br/>
Here is an example of all the function declarations related to the OpenCV function cvAdd(): </p>
<div class="fragment"><pre class="fragment"><span class="comment">//cxcore.h</span>
<span class="keywordtype">void</span> cvAdd(<span class="keyword">const</span> CvArr* src1, <span class="keyword">const</span> CvArr* src2, CvArr* dst, <span class="keyword">const</span> CvArr* mask CV_DEFAULT(NULL) );

<span class="comment">//cxcoreg.h</span>
<span class="keywordtype">void</span> <a class="code" href="group__CVGXCORE__OPER__ARITHM__LOGIC__COMP__GRP.html#ga46fd662a659ad05df9e8b7677d9d1fe5" title="GPUCV correspondence of cvAdd function.">cvgAdd</a>(CvArr* src1, CvArr* src2, CvArr* dst, CvArr* mask CV_DEFAULT(NULL) );

<span class="comment">//cxcoregcu.h</span>
<span class="keywordtype">void</span> <a class="code" href="group__CVGXCORE__OPER__ARITHM__LOGIC__COMP__GRP.html#ga6c79cbb6005eb1af2d60c3ae4f6766ca">cvgCudaAdd</a>(CvArr* src1, CvArr* src2, CvArr* dst, CvArr* mask CV_DEFAULT(NULL) );

<span class="comment">//cxcore_switch.h</span>
<span class="keywordtype">void</span> cvgswAdd(CvArr* src1, CvArr* src2, CvArr* dst, CvArr* mask CV_DEFAULT(NULL) );

<span class="comment">//cxcore_switch_wrapper.h</span>
<span class="preprocessor">#define cvAdd    cvgswAdd</span>
</pre></div><dl class="user"><dt><b>Using GpuCV auto-switch mechanism</b></dt><dd>Include all $NAME$<b>_switch_wrapper</b>.h files corresponding to your current OpenCV files. <br/>
NOTE: By using the switch mechanism you do not need to include GpuCV-GLSL or GpuCV-Cuda headers.</dd></dl>
<dl class="user"><dt><b>Using GpuCV manualy</b></dt><dd>You have the choice to use the GLSL, CUDA or both versions into your applications. Use the corresponding suffix <b>g</b> or <b>gcu</b> to include the corresponding libraries.</dd></dl>
<h2><a class="anchor" id="TUTO_INTEGRATION_PRJ__STP2__LIBS">
Library files</a></h2>
<p>GpuCV uses the naming convention described in previous section for its libraries files using the <b>g</b>/<b>gcu</b>/<b>_switch</b> suffixes.</p>
<p>Here are some list of files that you might have to link with: </p>
<ul>
<li>
Required libs: <ul>
<li>
<a class="el" href="namespacecv.html">cv</a>, cxcore, cvaux, highgui for main OpenCV libraries. </li>
<li>
opengl32, glu32, glut32, glew for all OpenGL libraries. </li>
<li>
SugoiTools, SugoiTracer </li>
<li>
GPUCVHardware, GPUCVTexture, GPUCVCore, GPUCVGpuCV for GpuCV framework </li>
</ul>
</li>
<li>
Optional libs: <ul>
<li>
cxcoreg, cvg, highguig for GpuCV-GLSL libraries. </li>
<li>
cxcoregcu, cvgcu for GpuCV-CUDA libraries. </li>
<li>
cxcore_switch, cv_switch, highgui_switch for GpuCV-Switch libraries. </li>
</ul>
</li>
</ul>
<dl class="note"><dt><b>Note:</b></dt><dd>By using the switch mechanism you do not need to link with GpuCV-GLSL or GpuCV-Cuda plugins. </dd>
<dd>
Even if you do not link with all the libraries, they must remain reachable in your $PATH.</dd></dl>
<h2><a class="anchor" id="TUTO_INTEGRATION_PRJ__STP3__CODE_CHANGE">
Code modifications</a></h2>
<h3><a class="anchor" id="TUTO_INTEGRATION_PRJ__STP3__CODE_CHANGE__INIT">
Initialization</a></h3>
<p>In order to use GpuCV function, you must initialize the libraries by calling <a class="el" href="group__CVG__MISC__GRP.html#gae9ff9ef6c8a7ac1824ebafb500668a9a" title="Initialize GpuCV library and framework, test extensions, and create or use a GL context...">cvgInit()</a> at the beginning of your application. Two parameters can be used to specify options (see <a class="el" href="group__CVG__MISC__GRP.html#gae9ff9ef6c8a7ac1824ebafb500668a9a" title="Initialize GpuCV library and framework, test extensions, and create or use a GL context...">cvgInit()</a> for details):</p>
<p>InitGLContext: If set to true, GpuCV will initialize an OpenGL context and GLUT, default is TRUE. isMultiThread: If set to true, GpuCV will run in a compatibility mode for multi-threaded application, default is FALSE.</p>
<h3><a class="anchor" id="TUTO_INTEGRATION_PRJ__STP3__CODE_CHANGE__CALL">
OpenCV function calls</a></h3>
<p>Now you are ready to make calls to cvg operators, the calling convention of GpuCV operators is cvgOperator. Consult the list of available operators to find OpenCV operators already ported to GPU or go to How to call GpuCVOperators for more details.</p>
<h2><a class="anchor" id="TUTO_INTEGRATION_PRJ__STP4__EXTRA_FILES">
Extra files</a></h2>
<p>GLSL filter files GpuCV operators are mainly base on GLSL shader programs that are executed on GPU. Theses programs are automatically compiled at runtime by GpuCV and must be reachable by your application to work correctly: </p>
<ul>
<li>
Have a local copy of folders FShaders and VShaders from ./GPUCV/bin/ into your current directory at runtime. OR </li>
<li>
Set the shader program path before initializing GpuCV libraries(<a class="el" href="group__CVG__MISC__GRP.html#gae9ff9ef6c8a7ac1824ebafb500668a9a" title="Initialize GpuCV library and framework, test extensions, and create or use a GL context...">cvgInit()</a>) by calling the function <a class="el" href="group__CVG__MISC__GRP.html#ga93548090714219cece74da9693643fa4" title="Define the path where the library will find &quot;VShaders&quot; and &quot;FShaders&quot;...">cvgSetShaderPath()</a> from misc.h. The given path must be the root directory containing FShaders and VShaders folders, ex: "c:\program_files\gpucv\bin\". </li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1">
<table border="0" width="100%">
<tr>
<td>
Retrieve latest informations, releases and documentation on <a href="https://picoforge.int-evry.fr/cgi-bin/twiki/view/Gpucv/Web/WebHome">GpuCV website</a>.
</td>
<td width ="50">
</td>
<td>
<address style="text-align: right;"><small>Generated
on Wed Oct 22 20:37:13 2008 for <a href="https://picoforge.int-evry.fr/cgi-bin/twiki/view/Gpucv/Web/WebHome">GpuCV</a> by&nbsp;
<a href="http://www.doxygen.org/index.html"><img
 src="doxygen.png" alt="doxygen" align="middle"
 border="0"></a> 1.5.4 </small></address>
 </td>
 </tr>
 </table>
